apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: staging

# Render Helm chart first
helmCharts:
- name: cfb
  repo: file://../../../cfb/helm
  releaseName: cfb
  version: 0.1.0
  valuesInline:
    replicaCount: 1

# Patch ConfigMap with staging-specific values
patches:
- path: configmap-patch.yaml

# Patch Secret with staging-specific API key
secretGenerator:
- name: cfb-secrets
  literals:
  - cfbd-api-key=your_staging_api_key_here
  behavior: merge
